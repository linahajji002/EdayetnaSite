<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{% block title %}Back Office EDAYETNA{% endblock %}</title>
    <!-- plugins:css -->
    {% block css %}
               
      <link href="{{ asset('build/assets/vendors/feather/feather.css') }}" rel="stylesheet">
      <link href="{{ asset('build/assets/vendors/css/vendor.bundle.base.css') }}" rel="stylesheet">
      <link href="{{ asset('build/assets/vendors/css/vendor.bundle.base.css') }}" rel="stylesheet">
      <link href="{{ asset('build/assets/vendors/font-awesome/css/font-awesome.min.css') }}" rel="stylesheet">
      <link href="{{ asset('build/assets/vendors/mdi/css/materialdesignicons.min.css') }}" rel="stylesheet">
      <!-- endinject -->
      <!-- Plugin css for this page -->
      <!-- <link rel="stylesheet" href="assets/vendors/datatables.net-bs4/dataTables.bootstrap4.css"> -->
      <link rel="stylesheet" href="{{ asset('build/assets/vendors/datatables.net-bs5/dataTables.bootstrap5.css') }}">
      <link rel="stylesheet" href="{{ asset('build/assets/vendors/ti-icons/css/themify-icons.css') }}">
      <link rel="stylesheet" type="text/css" href="{{ asset('build/assets/js/select.dataTables.min.css') }}">
      <!-- End plugin css for this page -->
      <!-- inject:css -->
              <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

      
      <link rel="stylesheet" href="{{ asset('build/assets/css/style.css') }}">
      <style>
 .modal-backdrop {
    backdrop-filter: blur(10px); /* Flou sur l'arrière-plan */
    background-color: rgba(0, 0, 0, 0.51) !important; /* Assombri légèrement */
}
/* Close button */
.closee-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 22px;
    cursor: pointer;
    color: #191e3a;
}


.closee-btn:hover {
    color:#547587; /* Red on hover */
}
/* Ensure the rest of the page is blurred when modal is open */
body.modall-open {
    overflow: hidden;
}
{#  #}

    /* Corrige le problème de focus sur le champ */
    #photoModal {
        box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.3); /* Ombre plus prononcée */
    border-radius: 10px; /* Bords arrondis pour un design moderne */
        z-index: 1055 !important;
        
    }
    /* Espacement pour la section */
    .mrg {
        margin-top: 100px;
        margin-bottom: 50px;
    }

    /* Style de la photo */
    .profile-img {
        width: 200px;
        height: 200px;
        object-fit: cover;
        position: relative;
    }

    /* Bouton de modification de photo */
    .edit-photo-btn {
        position: absolute;
        bottom: 10px;
        right: 10px;
        border-radius: 50%;
        padding: 8px;
        width: 35px;
        height: 35px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: white;
        cursor: pointer;
    }

    /* Style du nom et prénom sous la photo */
    .user-name {
        color: #191e3a;
        font-size: 20px;
    }

    /* Séparation entre la photo et les infos */
    .vr {
        width: 2px;
        background: #ccc;
        height: 100%;
    }

    /* Style des boutons */
  
</style>

     {% endblock %}
    <!-- endinject -->
    <link rel="shortcut icon" href="{{ asset('build/assets/images/logo 1.svg') }}" />
  </head>
  <body>
  
  {% block body %}
    <div class="container-scroller">
      
      <!-- partial:partials/_navbar.html -->
      <nav class="navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
  <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-start">
    <a class="navbar-brand brand-logo me-5" href="index.html"><img src="{{ asset('build/assets/images/logo 2.svg') }}" class="me-2" alt="logo" /></a>
  </div>
  <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
    <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
      <span class="icon-menu"></span>
    </button>
 
    <ul class="navbar-nav navbar-nav-right">
      
      <li class="nav-item nav-profile dropdown">
        <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown" id="profileDropdown">
          {% if app.user.photo %}
                                <img src="{{ asset('build/assets/images/' ~ app.user.photo) }}" 
                                    
                                    width="50" height="50" 
                                    style="border-radius: 50%; object-fit: cover;">
                      
                            {% else %}
                                <img src="{{ asset('build/assets/images/userbb.jpeg') }}" 
                                    
                                    width="50" height="50" 
                                    style="border-radius: 50%; object-fit: cover;">
                            {% endif %}<span class="username">{{ app.user.prenom }}.{{ app.user.nom }}</span>
        </a>
        <div class="dropdown-menu dropdown-menu-right navbar-dropdown" aria-labelledby="profileDropdown">
          <a href="{{ path('profil_artisan_back', { 'id': app.user.id }) }}" class="dropdown-item" >
            <i class="ti-settings text-primary"></i> Profil </a>
          <a class="dropdown-item" href="{{ path('app_logout') }}">
            <i class="ti-power-off text-primary"></i> Déconnexion </a>
        </div>
      </li>
      
    </ul>
    <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
      <span class="icon-menu"></span>
    </button>
  </div>
</nav>
      <!-- partial -->
        <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:partials/_sidebar.html -->
        <nav class="sidebar sidebar-offcanvas" id="sidebar">
  <ul class="nav">
    <li class="nav-item">
      <a class="nav-link" href="{{ path('app_admin') }}">
        <i class="icon-grid menu-icon"></i>
        <span class="menu-title">Dashboard</span>
      </a>
    </li>
    <li class="nav-item">
      
    </li>
    <li class="nav-item">
      <a class="nav-link" data-bs-toggle="collapse" href="#form-elements" aria-expanded="false" aria-controls="form-elements">
        <i class="mdi mdi-cube"></i>
        <span class="menu-title">Produits</span>
        <i class="menu-arrow"></i>
      </a>
      <div class="collapse" id="form-elements">
        <ul class="nav flex-column sub-menu">
          <li class="nav-item"><a class="nav-link" href="#">Table</a></li>
        </ul>
      </div>
    </li>
    <li class="nav-item">
      <a class="nav-link" data-bs-toggle="collapse" href="#charts" aria-expanded="false" aria-controls="charts">
        <i class="mdi mdi-bowl"></i>
        <span class="menu-title">Ateliers en ligne</span>
        <i class="menu-arrow"></i>
      </a>
      <div class="collapse" id="charts">
        <ul class="nav flex-column sub-menu">
          <li class="nav-item"> <a class="nav-link" href="{{ path('app_atelierenligne') }}">Table</a></li>
          <li class="nav-item"> <a class="nav-link" href="{{ path('app_planning') }}">Planning</a></li>
        </ul>
      </div>
    </li>
    <li class="nav-item">
      
    </li>
    <li class="nav-item">
      
    </li>
   
   
    
  </ul>
</nav>
{# iiiiiiiiiiiiiiiiii #}
<div class="container mt-5" >
 <div class="title-gestion"> Mon profil </div>
    <div class="row justify-content-center">
        <div class="col-md-9">
   
                <div class="card p-5 shadow-lg rounded" data-aos="fade-up">
                    <div class="row">
                        <!-- Colonne de la photo -->
                        <div class="col-md-4 d-flex flex-column align-items-center position-relative">
                            <div class="position-relative">
                            {% if user.photo %}
                                <img src="{{ asset('build/assets/images/' ~ user.photo) }}" 
                                    
                                     class="rounded-circle border shadow-sm mb-3 profile-img">
                      
                            {% else %}
                                <img src="{{ asset('build/assets/images/userf.png') }}" 
                                    
                                     class="rounded-circle border shadow-sm mb-3 profile-img">
                            {% endif %}
                        
                                
                                <!-- Icône de modification de la photo -->
                                <button class=" edit-photo-btn" id="editPhotoBtn">
                                    <i class="fas fa-pencil-alt"></i>
                                </button>
                            </div>

                            <!-- Affichage du Nom et Prénom sous la photo -->
                            <h4 class="mt-3 text-center fw-bold user-name">{{ user.nom }} {{ user.prenom }}</h4>
                        </div>

                        <!-- Colonne de séparation fine -->
                        <div class="col-md-1 d-flex align-items-center">
                            <div class="vr"></div>
                        </div>

                        <!-- Colonne des informations utilisateur -->
                        <div class="col-md-7">
                            <form novalidate method="post" action="{{ path('profil_user_back_update', { 'id': user.id }) }}" class="mt-2">
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Nom</label>
                                    <input type="text" class="form-control form-input" name="nom" value="{{ user.nom }}">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Prénom</label>
                                    <input type="text" class="form-control form-input" name="prenom" value="{{ user.prenom }}">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Email</label>
                                    <input type="email" class="form-control form-input" name="email" value="{{ user.email }}">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Adresse</label>
                                    <input type="text" class="form-control form-input" name="adresse" value="{{ user.adresse }}">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Numéro de téléphone</label>
                                    <input type="text" class="form-control form-input" name="numTel" value="{{ user.numTel }}">
                                </div>
                                <hr>
                                <h4 class="mt-4 text-center">Modifier le mot de passe</h4>
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Mot de passe actuel</label>
                                    <input type="password" class="form-control form-input" name="current_password" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Nouveau mot de passe</label>
                                    <input type="password" class="form-control form-input" name="new_password">
                                </div>
                                <div class="text-center">
                                    <button type="submit" class="btn btn-success">Enregistrer</button>
                                </div>
                            </form>
                      
                    </div>
                </div> <!-- Fin .card -->
            </div> <!-- Fin .mrg -->
        </div>
    </div>
</div>


<!-- Boîte modale pour modifier la photo -->
<div id="photoModal" class="modal fade" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered"> 
        <div class="modal-content">
            <div class="modal-header">
              <span class="closee-btn">&times;</span>
                <h5 class="modal-title">Modifier la photo</h5>
            </div>
            <div class="modal-body">
                <form id="photoForm" method="post" action="{{ path('update_back_photo', { 'id': user.id }) }}">
                    <div class="mb-3">
                        <label class="form-label">Nouveau nom de la photo</label>
                        <input type="text" class="form-control" name="photo" id="photoInput" required>
                    </div>
                    <div class="text-center">
                        <button type="submit" class="btn btn-success">Confirmer</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Style pour aligner et espacer le nom et prénom sous la photo -->

<!-- Script pour ouvrir la boîte modale -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Récupérer le bouton qui ouvre la modal
        var editPhotoBtn = document.getElementById("editPhotoBtn");
        var photoModal = new bootstrap.Modal(document.getElementById("photoModal"));

        // Ouvrir la modal lorsqu'on clique sur "Modifier la photo"
        if (editPhotoBtn) {
            editPhotoBtn.addEventListener("click", function () {
                photoModal.show();
                setTimeout(() => {
                    var photoInput = document.getElementById("photoInput");
                    if (photoInput) {
                        photoInput.focus();
                    }
                }, 500);
            });
        }

        // Bouton de fermeture de la modal
        const closeModalButtons = document.querySelectorAll(".closee-btn");

        closeModalButtons.forEach(button => {
            button.addEventListener("click", function () {
                photoModal.hide();
            });
        });

        // Fermer la modal lorsqu'on clique en dehors du contenu
        document.getElementById("photoModal").addEventListener("click", function (event) {
            if (event.target.classList.contains("modal")) {
                photoModal.hide();
            }
        });
    });
</script>



<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
{% endblock %}

